id: CVE-2017-5871

info:
  name: Open URL redirect 
  author: osamahamad
  severity: low
  description: A user-controlled input redirects users to an external website.
  tags: redirect,generic

requests:
  - method: GET

    path:
      - '{{BaseURL}}/web/session/logout?redirect=https%3A%2F%2Fexample.com%2F'
      - '{{BaseURL}}/web/dbredirect?redirect=https%3A%2F%2Fexample.com%2F'
      - '{{BaseURL}}/session/logout?redirect=https%3A%2F%2Fexample.com%2F'
      - '{{BaseURL}}/dbredirect?redirect=https%3A%2F%2Fexample.com%2F'
      
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)example\.com.*$'
        part: header

      - type: status
        status:
          - 302
          - 301
