id: malicious-pip-requriments-dependency-v2

info:
  name: pip requirments have malicious packages disclosure
  author: osamahamad
  severity: critical
  description: The following template scan for malicious pip packages based on https://security.snyk.io/vuln/npm/ -- all pages from 2011 cves https://security.snyk.io/vuln/pip/103 until 6-7-2022 last page  . only NPM
  tags: config,exposure

requests:
  - method: GET
    path:
      - "{{BaseURL}}/requirements.txt"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "python-dateutils="
          - "pygrata-utils="
          - "pygrata="
          - "hkg-sol-utils="
          - "loglib-modules="
          - "notreallyapackagetrustme="
          - "@core-pas/cyb-core="
          - "request="
          - "13cent="
          - "16cent="
          - "15cent="
          - "12cent="
          - "oksana="
          - "11cent="
          - "14cent="
          - "requuests="
          - "reequests="
          - "requeests="
          - "equests="
          - "rrequests="
          - "reuests="
          - "reqquests="
          - "requessts="
          - "requestts="
          - "requess="
          - "ctx="
          - "secrevthree="
          - "discordcmd="
          - "marcador="
          - "karaspace="
          - "azure-cli-ml-preview="
          - "vapi-client-bindings="
          - "aml-ds-pipeline-contrib="
          - "sdk-cli-v2-public="
          - "aiohttp-socks4="
          - "mitmproxy-iframe="
          - "aiohttp-proxies="
          - "request.request="
          - "collored="
          - "azureml-contrib-reports="
          - "azure-cli-ml-private-preview="
          - "azureml-contrib-optimization="
          - "sdk-cli-v2="
          - "secbg="
          - "secrevtwo="
          - "infoglmi="
          - "are="
          - "maratlib="
          - "humanqueenn="
          - "distrib="
          - "mllearnlib="
          - "mplatlib="
          - "matplatlib-plus="
          - "dpp-client="
          - "learninglib="
          - "maratlib1="
          - "easyfuncsys="
          - "dpp-client1234="
          - "nmap-python="
          - "mumpy="
          - "python-mysqldb="
          - "smb="
          - "python-openssl="
          - "openvc="
          - "junkeldat="
          - "aws-login0tool="
          - "mitmproxy2="
          - "humanqueen="
          - "xss="
          - "virtualnv="
          - "python-mysql="
          - "python-sqlite="
          - "python-mongo="
          - "pythonkafka="
          - "python-ftp="
          - "web.py="
          - "aiohttp-socks5="
          - "asdeefdzfzs="
          - "xcryptography="
          - "aadhaarcrypt="
          - "xgoogle-cloud-storage="
          - "xsetuptools="
          - "openbabel-python="
          - "openrobotics="
          - "pycache-pycparser="
          - "apple-py-music="
          - "sagepay="
          - "asdeefdzfzs="
          - "xgoogle-cloud-core="
          - "xcryptography="
          - "botaa3="
          - "pptest="
          - "10cent10="
          - "yandex-yt="
          - "trrfab="
          - "yiffparty="
          - "10cent11="
          - "discordsafety="
          - "owlmoon="
          - "ipboards="
          - "important-package="
          - "importantpackage="
          - "pytagora2="
          - "pytagora="
          - "aryi="
          - "genesisbot="
          - "noblessev2="
          - "noblesse2="
          - "suffer="
          - "noblesse="
          - "python3-dateutil="
          - "jeilyfish="
          - "libpesh="
          - "libpeshnx="
          - "libari="
          - "rstseuqe="
          - "jajajejejiji="
          - "timeit="
          - "mybiubiubiu="
          - "djago="
          - "pkgutil="
          - "smplejson="
          - "diango="
          - "dajngo="
          - "colourama="
          - "pyconau-funtimes="
          - "libpeshka="
          - "djanga="
          - "easyinstall="
          - "ssh-decorate="
          - "pwd="
          - "django-server="
          - "setup-tools="
          - "telnet="
          - "acqusition="
          - "urllib="
          - "bzip="
          - "apidev-coop="
          - "urlib3="
          - "crypt="
          - "salt="
        condition: or
        
      - type: word
        words:
          - 'text/plain'
        part: header
        
      - type: status
        status:
          - 200
