id: open-redirect-CVE-2021-41826

info:
  name: Open URL redirect detection
  author: osamahamad
  severity: low
  description: A user-controlled input redirects users to an external website https://packetstormsecurity.com/files/164345/PlaceOS-1.2109.1-Open-Redirection.html
  tags: redirect,generic

requests:
  - method: GET

    path:
      - '{{BaseURL}}/auth/logout?continue=//example.com'
      - 'http://office.{{Hostname}}/auth/logout?continue=//example.com'
      - 'https://office.{{Hostname}}/auth/logout?continue=//example.com'

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)example\.com.*$'
        part: header

      - type: status
        status:
          - 302
          - 301
